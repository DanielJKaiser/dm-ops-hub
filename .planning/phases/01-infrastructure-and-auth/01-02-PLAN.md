---
phase: 01-infrastructure-and-auth
plan: 02
type: execute
wave: 2
depends_on: [01-01]
files_modified: [scripts/verify-mcp.sh, scripts/test-sheets-connection.py]
autonomous: false
requirements: [INFRA-03, INFRA-04]
user_setup:
  - service: outlook-mcp
    why: "Outlook MCP server requires npm install and OAuth flow on work laptop"
    env_vars:
      - name: OUTLOOK_CLIENT_ID
        source: "From .env MS_CLIENT_ID (set in Plan 01)"
      - name: OUTLOOK_CLIENT_SECRET
        source: "From .env MS_CLIENT_SECRET (set in Plan 01)"
    dashboard_config:
      - task: "Clone outlook-mcp repo and run npm install"
        location: "Terminal on work laptop"
      - task: "Run auth-server and complete OAuth flow in browser"
        location: "Terminal: npm run auth-server, then open localhost:3333"

must_haves:
  truths:
    - "Google Sheets MCP server starts and Claude can list spreadsheets in the shared Drive folder"
    - "Google Sheets MCP server can create a test spreadsheet and append a row"
    - "Outlook MCP server is configured and ready for authentication on work laptop"
    - "MCP verification script exists and tests both server connections"
  artifacts:
    - path: "scripts/verify-mcp.sh"
      provides: "MCP connection verification helper"
      min_lines: 10
    - path: "scripts/test-sheets-connection.py"
      provides: "Sheets API connection test via service account"
      min_lines: 20
  key_links:
    - from: ".env"
      to: "mcp-google-sheets"
      via: "GOOGLE_SERVICE_ACCOUNT_PATH and GOOGLE_DRIVE_FOLDER_ID env vars"
      pattern: "SERVICE_ACCOUNT_PATH"
    - from: ".env"
      to: "outlook-mcp"
      via: "MS_CLIENT_ID and MS_CLIENT_SECRET env vars"
      pattern: "OUTLOOK_CLIENT_ID"
---

<objective>
Install and verify Google Sheets MCP server on desktop. Prepare Outlook MCP configuration for work laptop. Create verification scripts to test both MCP connections.

Purpose: MCP servers are the bridge between Claude and external services. Google Sheets MCP is testable on desktop immediately. Outlook MCP requires work laptop with Outlook — prepare config and verify script now, authenticate later.
Output: Working Google Sheets MCP, Outlook MCP config ready, verification scripts.
</objective>

<execution_context>
@C:/Users/USER/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/USER/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-infrastructure-and-auth/01-RESEARCH.md
@.planning/phases/01-infrastructure-and-auth/01-CONTEXT.md
@.planning/phases/01-infrastructure-and-auth/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Google Sheets MCP and create connection test script</name>
  <files>scripts/test-sheets-connection.py</files>
  <action>
1. **Verify prerequisites:**
   - Check that `uv` or `uvx` is available: `uvx --version`
   - If not installed, install via: `pip install uv` or guide user to install
   - Read .env to get GOOGLE_SERVICE_ACCOUNT_PATH and GOOGLE_DRIVE_FOLDER_ID

2. **Test Google Sheets MCP server starts:**
   - The MCP server is invoked via `uvx mcp-google-sheets@latest` with env vars
   - Test by running with SERVICE_ACCOUNT_PATH and DRIVE_FOLDER_ID set
   - Verify it initializes without errors

3. **Create `scripts/test-sheets-connection.py`:**
   A Python script that tests the Google Sheets service account connection directly (independent of MCP):
   ```python
   """Test Google Sheets API connection via service account.

   Verifies: service account key is valid, Sheets API is enabled,
   Drive folder is accessible, can create/read/write spreadsheets.

   Usage: python scripts/test-sheets-connection.py
   Requires: pip install google-auth google-auth-httplib2 google-api-python-client python-dotenv
   """
   ```

   The script should:
   - Load .env using python-dotenv
   - Authenticate using the service account JSON key
   - List files in the shared Drive folder (verifies Drive API + sharing)
   - Create a test spreadsheet named "MCP Connection Test - [timestamp]"
   - Write a test row: ["Test", "Connection", "Verified", current_timestamp]
   - Read the row back and verify it matches
   - Print clear PASS/FAIL status for each step
   - Clean up: delete the test spreadsheet after verification

   Install dependencies first: `pip install google-auth google-auth-httplib2 google-api-python-client python-dotenv`

4. **Create MCP config entry for Claude Code:**
   Update or document the Claude Code MCP configuration. The user needs to add this to their Claude Code settings (`~/.claude/settings.json` or equivalent):
   ```json
   {
     "google-sheets": {
       "command": "uvx",
       "args": ["mcp-google-sheets@latest"],
       "env": {
         "SERVICE_ACCOUNT_PATH": "{absolute-path-to-service-account-key.json}",
         "DRIVE_FOLDER_ID": "{folder-id-from-env}"
       }
     }
   }
   ```
   Document the exact paths needed in a comment at the top of the test script.
  </action>
  <verify>
    Run: python scripts/test-sheets-connection.py
    Expected: All steps PASS — service account auth works, can list Drive folder, create/read/write spreadsheet, cleanup succeeds.
    If any step fails, the script prints which step failed and why.
  </verify>
  <done>
    test-sheets-connection.py runs successfully: authenticates with service account, creates a test spreadsheet in the shared folder, writes and reads back a test row, cleans up. Google Sheets MCP server config documented.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify Google Sheets MCP works in Claude session and prepare Outlook MCP</name>
  <files>scripts/verify-mcp.sh</files>
  <action>
Google Sheets MCP server is configured and the connection test script passes. Create scripts/verify-mcp.sh documenting the verification steps for both MCP servers. Now verify that Claude can actually use the MCP tools in a session, and prepare Outlook MCP config for work laptop.
  </action>
  <verify>
**Google Sheets MCP verification:**
1. Ensure MCP server config is added to your Claude Code/Desktop settings
2. Start a new Claude session
3. Ask Claude to list spreadsheets in the shared folder using the google-sheets MCP tool
4. Ask Claude to create a test spreadsheet and write "Hello from MCP" to cell A1
5. Verify the spreadsheet appears in Google Drive

**Outlook MCP preparation (for work laptop):**
The following Outlook MCP setup will be completed on the work laptop after pushing to GitHub:
1. Clone littlebearapps/outlook-mcp repo
2. Run `npm install` in the cloned repo
3. Create `.env` in outlook-mcp directory with MS_CLIENT_ID and MS_CLIENT_SECRET from dm-ops-hub .env
4. Run `npm run auth-server` to start OAuth server on port 3333
5. Open browser, complete Microsoft OAuth login with Daniel's work account
6. After auth completes, add outlet-mcp to Claude Code MCP config
7. Test: ask Claude to read latest email from inbox

The verification script (scripts/verify-mcp.sh) documents these steps.
  </verify>
  <done>Google Sheets MCP works in a Claude session — Claude can list and write to spreadsheets. Outlook MCP setup documented for work laptop. Verification script committed.</done>
  <resume-signal>Type "approved" if Google Sheets MCP works in a Claude session. Note if Outlook MCP setup on work laptop is deferred (expected — no Outlook on desktop).</resume-signal>
</task>

</tasks>

<verification>
After both tasks complete:
1. `scripts/test-sheets-connection.py` exists and runs successfully
2. Google Sheets MCP server responds to Claude tool calls in a session
3. Claude can list, create, and write to spreadsheets via MCP
4. Outlook MCP setup steps documented for work laptop
5. MCP config example updated with correct structure for both servers
</verification>

<success_criteria>
- Google Sheets MCP server starts without errors using service account auth
- test-sheets-connection.py passes all checks (auth, list, create, write, read, cleanup)
- Claude can use google-sheets MCP tools in an actual session (human verified)
- Outlook MCP configuration and setup steps documented for work laptop
- INFRA-03 partially complete (Outlook MCP ready for laptop auth), INFRA-04 fully complete (Sheets MCP working)
</success_criteria>

<output>
After completion, create `.planning/phases/01-infrastructure-and-auth/01-02-SUMMARY.md`
</output>
